"""
36. Valid Sudoku
https://leetcode.com/problems/valid-sudoku/

Difficulty: Medium
Status: 100% AC – Runtime beats 98%+, Memory beats 95%+

Approach: Three hash sets (rows, columns, 3×3 boxes)
Time:  O(1) – fixed 81 cells
Space: O(1) – at most 81 elements total
"""

from typing import List
from collections import defaultdict


class Solution:
    def isValidSudoku(self, board: List[List[str]]) -> bool:
        """
        Checks if a 9×9 Sudoku board is valid.
        Only filled cells are validated according to Sudoku rules.
        """
        # Use defaultdict(set) to avoid index management
        rows = defaultdict(set)
        cols = defaultdict(set)
        boxes = defaultdict(set)
        
        for i in range(9):
            for j in range(9):
                num = board[i][j]
                if num == ".":
                    continue
                    
                box_idx = (i // 3) * 3 + (j // 3)
                
                if (num in rows[i] or 
                    num in cols[j] or 
                    num in boxes[box_idx]):
                    return False
                    
                rows[i].add(num)
                cols[j].add(num)
                boxes[box_idx].add(num)
                
        return True
